<!doctype html>
<html lang="en">
<head>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="robots" content="noindex">
  <meta name="googlebot" content="noindex">


  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->

  <link rel="stylesheet", type="text/css" href="css/flatly.min.css" />
  <link rel="stylesheet", type="text/css" href="css/selectize.css" />


  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.18/b-1.5.4/b-flash-1.5.4/b-html5-1.5.4/b-print-1.5.4/datatables.min.css"/>


  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.18/b-1.5.4/b-flash-1.5.4/b-html5-1.5.4/b-print-1.5.4/datatables.min.js"></script>

  <script type="text/javascript" src="js/selectize.min.js"></script>
  <script type="text/javascript" src="js/plotly-latest.min.js"></script>

  <style>
  #bar-container {
    min-height: 600px !important;
  }
  #radar-container {
    min-height: 400px !important;
  }
  #incise-radar {
    min-height: 400px !important;
    min-width: 400px !important;
  }
  </style>

</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
    <a class="navbar-brand mb-0 h1" href="#">Test results dashboard</a>
    <ul class = "nav nav-pills" id="incise-tab-nav" role="tablist">
      <li class="nav-item " id="graph-tab"><a id="graph-tab-link" class="nav-link active" data-toggle="tab" href="#graph-panel">Graphs</a></li>
      <li class="nav-item " id="data-tab" data-container="body" data-toggle="popover" data-trigger="manual" data-placement="bottom" data-content="Select a country to view data"><a id="data-tab-link" class="nav-link" data-toggle="tab" href="#data-panel">Data</a></li>
      <li class="nav-item " id="ref-tab"><a id="ref-tab-link" class="nav-link" data-toggle="tab" href="#ref-panel">Metadata</a></li>
      <li class="nav-item " id="about-tab"><a id="about-tab-link" class="nav-link" data-toggle="tab" href="#about-panel">About</a></li>
    </ul>
  </nav>

<div class="container-fluid">

  <div class="modal fade" id="welcome-modal" tabindex="-1" role="dialog" aria-labelledby="welcome-modal-title" aria-hidden="true">
    <div class="modal-dialog modal-info" role="document">
      <div class="modal-content">
        <div class="modal-header bg-light" style="text-align:center;">
          <h4 class="modal-title" id="welcome-modal-title">Welcome to the InCiSE 2019 results dashboard</h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="alert alert-danger" style="text-align:center">
            This is a demonstration dashboard.<br />Please note, all data in this example is simulated.
          </div>
          <p>This interactive dashboard allows you to explore the results of the 2019 edition of the InCiSE index, including: graphs of the results, a datatable of results, and metadata about the InCiSE metrics.</p>
          <p>Use the controls below to select a country and to switch between the InCiSE index and its constituent indicators.</p>
          <p>Use the buttons at the top of the page to switch between graphs, data and metadata. The data tab will be enabled when you select a country.</p>
        </div>
        <div class="modal-footer small bg-light">
          <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-sm btn-info" id="welcome-more-btn">Read more</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade bd-modal-lg" id="intro-modal" tabindex="-1" role="dialog" aria-labelledby="into-modal-title" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header bg-light">
          <h4 class="modal-title" id="intro-modal-title">An introduction to InCiSE</h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>The International Civil Service Effectiveness index (InCiSE) aims to assess how effectively civil services around the world perform and to identify in which areas their strengths lie relative to their international counterparts.</p>
          <p>The InCiSE index has been designed on a framework developed in discussion with officials from national governments, international organisations, civil society partners and academics. This framework defines 17 functions and attributes that contribute to civil service effectiveness - at present, due to data availability, only 12 have been included in the index. These functions and attributes, collectively called indicators, are then disaggregated into individual metrics.</p>
          <hr />
          <h5>Using this dashboard</h5>
          <p>This dashboard allows users to interact with the results of the 2019 edition of the InCiSE index with graphs and tables. There are four tabs:</p>
          <ul>
            <li>Graphs: to view charts of the InCiSE results.</li>
            <li>Data: to view tables of the InCiSE results.</li>
            <li>Metadata: to view metadata about the InCiSE results.</li>
            <li>About: to learn more about the InCiSE index and project.</li>
          </ul>
          <p>Use the controls in the left-hand sidebar to select a country and either the InCiSE index or one of its constituent indicators. There are also controls to turn the help text on or off, and to show this introduction again.</p>
          <hr />
          <h5>Graphs</h5>
          <p>The graphs tab (the default tab) provides charts of the InCiSE results.</p>
          <ul>
            <li>The bar graph on the left shows the overall index or indicator scores for all 38 countries.</li>
            <li>The radar graph on the right shows the results for the constituent components of the score - when the index is selected it will show you the scores for the 12 InCiSE indcators, when an indicator is selected it will show you the scores for the metrics that make up that indicator.</li>
            <li>The radar chart shows the selected country's scores and the InCiSE average.</li>
            <li>A radar point with a white fill means that the data for that data for the indicator/metric is missing for that country and has been imputed.</li>
          </ul>
          <hr />
          <h5>Data</h5>
          <p>The data tab provides a table of the results for the selected country and indicator. At the bottom of the table you can use the buttons to copy this table to the clipboard, download this specific table as a CSV file, or download a CSV file containing all the data from the 2019 edition of InCISE.</p>
          <hr />
          <h5>Metadata</h5>
          <p>This metadata tab provides a table of the refence metadata about the selected indicator. At the bottom of the table you can use the buttons to copy this table to the clipboard, download this specific table as a CSV file, or download a CSV file containing all the metadata from the 2019 edition of InCISE.</p>
          <hr />
          <h5>About</h5>
          <p>The about tab provides some general background about the InCiSE project and its methodology.</p>
        </div>
        <div class="modal-footer small bg-light">
          <button type="button" class="btn btn-sm btn-outline-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<div class="row">

<div class="col-lg-2 p-3 bg-light" id="incise-sidebar">
  <div class="card border-info" id="incise-controls">
    <div class="card-header bg-info" style="color: #ffffff;">Graph and data controls</div>
    <div class="card-body">
      <div id="incise-selectors">
        <div id="country-selector">
        <label for="select-country">Select a country:</label>
        <select id="select-country">
          <option disabled selected value="">Select a country:</option>
          <option value="BDG">BDG</option>
          <option value="BKV">BKV</option>
          <option value="CHQ">CHQ</option>
          <option value="CPJ">CPJ</option>
          <option value="FTG">FTG</option>
          <option value="GIP">GIP</option>
          <option value="GSA">GSA</option>
          <option value="GUJ">GUJ</option>
          <option value="GUX">GUX</option>
          <option value="HEU">HEU</option>
          <option value="HUQ">HUQ</option>
          <option value="IJM">IJM</option>
          <option value="INZ">INZ</option>
          <option value="JDH">JDH</option>
          <option value="JYK">JYK</option>
          <option value="KBJ">KBJ</option>
          <option value="KVY">KVY</option>
          <option value="LFO">LFO</option>
          <option value="LGM">LGM</option>
          <option value="MLV">MLV</option>
          <option value="MMR">MMR</option>
          <option value="MOQ">MOQ</option>
          <option value="NPE">NPE</option>
          <option value="OES">OES</option>
          <option value="ONU">ONU</option>
          <option value="QKB">QKB</option>
          <option value="QNT">QNT</option>
          <option value="RNZ">RNZ</option>
          <option value="SHB">SHB</option>
          <option value="TQN">TQN</option>
          <option value="TRU">TRU</option>
          <option value="UQB">UQB</option>
          <option value="UYD">UYD</option>
          <option value="VFC">VFC</option>
          <option value="VLO">VLO</option>
          <option value="VQC">VQC</option>
          <option value="YGT">YGT</option>
          <option value="YRO">YRO</option>
        </select>
      </div>
      <div id="indicator-selector">
        <label for="select-indicator">Select an indicator:</label>
        <select id="select-indicator">
          <option value="OVERALL">InCiSE Index</option>
          <option value="CAP">Capabilities</option>
          <option value="CRM">Crisis and risk management</option>
          <option value="DIG">Digital services</option>
          <option value="FFM">Fiscal and financial management</option>
          <option value="HRM">HR management</option>
          <option value="INC">Inclusiveness</option>
          <option value="INT">Integrity</option>
          <option value="OPN">Openness</option>
          <option value="POL">Policy making</option>
          <option value="PRO">Procurement</option>
          <option value="REG">Regulation</option>
          <option value="TAX">Tax administration</option>
        </select>
      </div>
      </div>
      <div class="pt-3 small">
        <div class="custom-control custom-switch">
          <input type="checkbox" class="custom-control-input" id="toggle-help" checked="true">
          <label class="custom-control-label" for="toggle-help">Show help</label>
        </div>
        <div class="custom-control custom-switch">
          <input type="checkbox" class="custom-control-input" id="toggle-intro">
          <label class="custom-control-label" for="toggle-intro">Show introduction</label>
        </div>
      </div>
    </div>
  </div>

</div>

<div class="col p-3">

<div class="tab-content " id="incise-tab-content">

<div class="tab-pane active" id="graph-panel">
  <div class="alert alert-dismissible alert-light fade show help" id="graph-alert">
    <button type="button" class="close" id="graph-close">&times;</button>
    <strong class="text-primary">Graphs:</strong>
    <ul>
      <li>These graphs show the results for the InCiSE index or indicator you have selected.</li>
      <li>The bar graph on the left shows the overall index or indicator scores for all 38 countries.</li>
      <li>The radar graph on the right shows the results for the constituent components of the score - when the index is selected it will show you the scores for the 12 InCiSE indcators, when an indicator is selected it will show you the scores for the metrics that make up that indicator.</li>
      <li>The radar chart shows the selected country's scores and the InCiSE average.</li>
      <li>A radar point with a white fill means that the data for that data for the indicator/metric is missing for that country and has been imputed.</li>
    </ul>
    </div>
      <div id="graph-container" class="text-center d-none d-md-block d-print-block">
        <div id="incise-graph"></div>
    </div>
    <div id="bar-container" class="embed-responsive d-md-none d-print-none">
      <div id="incise-bar" class="embed-responsive-item"></div>
    </div>
    <div id="radar-container" class="embed-responsive d-md-none d-print-none">
      <div id="incise-radar" class="embed-responsive-item"></div>
    </div>
</div>

<div class="tab-pane fade " id="data-panel">
  <div class="alert alert-dismissible alert-light fade show help" id="data-alert">
    <button type="button" class="close" id="data-close">&times;</button>
    <strong class="text-primary">Data table:</strong> This table shows the results for the selected indicator. At the bottom of the table you can use the buttons to copy this table to the clipboard, download this specific table as a CSV file, or download a CSV file containing all the data from the 2019 edition of InCISE.
  </div>
  <h5 id="data-title" class="mt-3">Data table</h5>
  <div class="table-responsive-lg">
    <table id="incise-table" class="table table-striped"></table>
  </div>
</div>

<div class="tab-pane fade " id="ref-panel">
  <div class="alert alert-dismissible alert-light fade show help" id="metadata-alert">
    <button type="button" class="close" id="metadata-close">&times;</button>
    <strong class="text-primary">Metadata:</strong> This table shows the refence metadata about the InCiSE index or the selected indicator. At the bottom of the table you can use the buttons to copy this table to the clipboard, download this specific table as a CSV file, or download a CSV file containing all the metadata from the 2019 edition of InCISE.
  </div>
  <h5 id="ref-title" class="mt-3">InCiSE metadata table</h5>
  <div class="table-responsive-lg">
    <table id="ref-table" class="table table-striped table-sm"></table>
  </div>
</div>

<div class="tab-pane fade" id="about-panel">
    <div class = "row">
      <div class="col-md-4">
        <h3>About InCiSE</h3>
        <p>The International Civil Service Effectiveness (InCiSE) Index was launched as a pilot in 2017, this dashboard shows the results from the section edition published in 2019. Recognising the important role civil services can play in helping their countries to prosper, InCiSE aims to assess how effectively civil services around the world perform and to identify in which areas their strengths lie relative to their international counterparts.</p>
        <p>InCiSE aspires progressively to become a robust, comparative measure of civil service performance, but is not that yet – mainly because of data limitations. In addition, InCiSE does not seek to be definitive: it will be important to assess its results alongside other evidence available to leaders and citizens. The InCiSE Index should be seen as one of a range of tools available to measure civil service effectiveness globally.</p>
        <p>InCiSE is a collaboration of the <a href="https://www.bsg.ox.ac.uk">Blavatnik School of Government</a> and the <a href="https://www.instituteforgovernment.org.uk/">Institute for Government</a>. It has been supported by the UK Civil Service and has recieved funding from the Open Society Foundations.</p>
      </div>
      <div class="col-md-8"><h3>Methodology</h3>
        <div class="row">
          <div class="col-sm">
      <p>The InCiSE index brings together data from a wide and varied range of sources. In their raw state these data not directly comparable, some data may be statistics or proportions, some might be ratings on different scales (e.g. 1 to 5 or 0 to 10), and some are categorical data. The InCiSE model processes and normalises the different types of data so that country performance in different domains can be compared. Full details of the methodology can be found in the InCiSE 2019 Technical Report.</p>
      <h5>InCiSE framework and model</h5>
      <p>The InCiSE index has been designed on a framework developed in discussion with officials from national governments, international organisations, civil society partners and academics. This framework defines 17 functions and attributes that contribute to civil service effectiveness - at present, due to data availability, only 12 have been included in the index. These functions and attributes, collectively called indicators, are then disaggregated into individual metrics.</p>
      <h5>Data sources</h5>
      <p>InCiSE draws on data from a wide range of data sources, and we are thankful to data providers for allowing the resuse of their data. A full list of data sources can be found below. InCiSE is built using the latest available data as of 30 Novmeber 2018.</p>
    </div>
      <div class="col-sm">
        <h5>Data quality and imputation</h5>
        <p>Not all sources cover all 38 countries included in the index, with data availability and quality varying across both countries and indicators. In some cases countries are missing just a few metrics for an indicator, while others are missing all data for a given indicator. In order to provide a practical tool for users, the InCiSE model uses multiple imputation to provide indicative scores for missing data points. These are clearly flagged on the graphs and tables in this dashboard.</p>
        <p>The InCiSE model has developed a data quality assessment which assesses the level of missing data for each country and indicator, and also accounts for whether data is from a public sector proxy and the recency of the data. This data quality assessment has been used to determine country coverage.</p>
  <h5>Weighting</h5>
  <p>The scores for the InCiSE indicators are weighted sums of their constituent metrics. The InCiSE index is then calcualted as a weighted sum of the indcators. The weights for metrics and indicators can be found in the metadata table.</p>
  </div>
  </div>
  </div>
  </div>
    <hr />
    <div class = "row">
      <div class="col-sm">
        <h5>Data Sources</h4>
        <small>
        <ul class="list-unstyled">
          <li class="p-1">Bertelsmann Stiftung (2018) <a href="http://www.sgi-network.org">Sustainable Governance Indicators 2018</a>, Gütersloh, Germany: Bertelsmann Stiftung</li>
          <li class="p-1">Dahlström C, Teorell J, Dahlberg S, Hartmann F, Lindberg A and Nistotskaya M (2015) <a href="https://qog.pol.gu.se/data/datadownloads/qogexpertsurveydata">The QoG Expert Survey Dataset II</a>, Gothenburg: University of Gothenburg, The Quality of Government Institute</li>
          <li class="p-1">DIGIWHIST (2018) <a href="https://opentender.eu">Opentender</a>, Hungary: Government Transparency Institute</li>
          <li class="p-1">European Commission (2018) <a href="https://ec.europa.eu/digital-single-market/en/news/egovernment-benchmark-2018-digital-efforts-european-countries-are-visibly-paying">eGovernment Benchmark Report 2018</a>, Brussels: European Commission</li>
          <li class="p-1">International Budget Partnership (2018) <a href="http://survey.internationalbudget.org">Open Budget Survey 2017</a>, Washington DC: International Budget Partnership</li>
          <li class="p-1">ILO (2018) <a href="https://www.ilo.org/ilostat/">ILO Statistics</a>, Geneva: International Labour Organization</li>
          <li class="p-1">OECD (2013) <a href="https://doi.org/10.1787/gov_glance-2013-en">Government at a Glance 2013</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2015) <a href="https://doi.org/10.1787/gov_glance-2015-en">Government at a Glance 2015</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2016) <a href="https://qdd.oecd.org/subject.aspx?Subject=GOV_RISK">Dataset on the Governance of Critical Risks</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2016) <a href="https://qdd.oecd.org/subject.aspx?Subject=GOV_PUBPRO_2016">Dataset on Public Procurement</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2017) <a href="https://doi.org/10.1787/gov_glance-2017-en">Government at a Glance 2017</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2017) <a href="https://qdd.oecd.org/subject.aspx?Subject=TAS ">Tax Administration Comparative Information Series</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2018) <a href="https://stats.oecd.org/Index.aspx?QueryId=85336 ">Composite Indicators of Regulatory Policy and Governance</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">OECD (2012-2018) <a href="http://www.oecd.org/skills/piaac/">Survey of Adult Skills (Programme for International Assessment of Adult Competencies)</a>, Paris: Organisation for Economic Cooperation and Development</li>
          <li class="p-1">Open Knowledge International (2017) <a href="https://index.okfn.org/">Global Open Data Index</a>, London: Open Knowledge Foundation</li>
          <li class="p-1">Transparency International (2017) <a href="http://gcb.transparency.org/">Global Corruption Barometer</a>, Berlin: Transparency International</li>
          <li class="p-1">UNDESA (2018) <a href="https://publicadministration.un.org/egovkb/en-us/Reports/UN-E-Government-Survey-2018">United Nations E-Government Survey 2018</a>, New York: United Nations</li>
          <li class="p-1">UNESCO Institute for Statistics (2018) <a href="http://data.uis.unesco.org/index.aspx?queryid=168">Population by minimum completed level of education (cumulative)</a>, Montreal: UNESCO Institute for Statistics</li>
          <li class="p-1">UNIDRR (2016) <a href="https://www.preventionweb.net/applications/hfa/qbnhfa/">Hyogo Framework for Action National Progress Query Tool</a>, New York: United Nations</li>
          <li class="p-1">World Bank (2017) <a href="https://datacatalog.worldbank.org/dataset/fmis-and-open-budget-data-global-dataset">FMIS And Open Budget Data Global Dataset</a>, Washington DC: The World Bank</li>
          <li class="p-1">World Bank (2018) <a href="http://www.doingbusiness.org/">Doing Business 2019</a>, Washington DC: The World Bank</li>
          <li class="p-1">World Economic Forum (2017) <a href="http://reports.weforum.org/global-competitiveness-index-2017-2018/downloads/">Global Competitiveness Index 2017-18 (Executive Opinion Survey)</a>, Geneva: World Economic Forum</li>
          <li class="p-1">World Justice Project (2018) <a href="https://worldjusticeproject.org/our-work/wjp-rule-law-index/wjp-rule-law-index-2017%E2%80%932018">Rule of Law Index 2017-18</a>, Washington DC: World Justice Project</li>
          <li class="p-1">World Wide Web Foundation (2017) <a href="https://opendatabarometer.org/4thedition/">Open Data Barometer: 4th Edition</a>, Washington DC: World Wide Web Foundation</li>
        </ul>
      </small>

      </div>
      <div class="col-sm"><h5>Software packages</h4>
        <p>The technical model and analysis for the 2019 edition of the InCiSE model was developed using R, a statistical programming language. This dashboard is developed using Plotly.JS, Datatables and Bootswatch.</p>
        <p>The R packages used in developing InCiSE are:</p>
        <small>
          <ul class="list-unstyled">
            <li class="p-1">Arel-Bundock V, Enevoldsen N and Yetman CJ (2018) “countrycode: An R package to convert country names and country codes”, Journal of Open Source Software 3(28): 848, <a href="https://doi.org/10.21105/joss.00848">https://doi.org/10.21105/joss.00848</a></li>
            <li class="p-1">Bescond D (2018) Rilostat: ILO Open Data via Ilostat Bulk Download Facility or SDMX Web Service, R package version 0.2.1, <a href="https://CRAN.R-project.org/package=Rilostat">https://CRAN.R-project.org/package=Rilostat</a></li>
            <li class="p-1">Caro DH and Biecek P (2017) “intsvy: An R Package for Analyzing International Large-Scale</li>
            <li class="p-1">Assessment Data” Journal of Statistical Software 81(7): 1-44, <a href="http://doi.org/10.18637/jss.v081.i07">http://doi.org/10.18637/jss.v081.i07</a></li>
            <li class="p-1">Firke S (2018) janitor: Simple Tools for Examining and Cleaning Dirty Data, R package version 1.1.1, <a href="https://CRAN.R-project.org/package=janitor">https://CRAN.R-project.org/package=janitor</a></li>
            <li class="p-1">Henry L and Wickham H (2017) purrr: Functional Programming Tools, R package version 0.2.4, <a href="https://CRAN.R-project.org/package=purrr">https://CRAN.R-project.org/package=purrr</a></li>
            <li class="p-1">Milton Bache S and Wickham H (2014) magrittr: A Forward-Pipe Operator for R, R package version 1.5, <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a></li>
            <li class="p-1">Müller K and Wickham H (2017) tibble: Simple Data Frames, R package version 1.3.4, <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a></li>
            <li class="p-1">R Core Team (2016) R: A language and environment for statistical computing, R Foundation for Statistical Computing, Vienna, Austria, <a href="https://www.R-project.org/">https://www.R-project.org/</a></li>
            <li class="p-1">van Buuren S and Groothuis-Oudshoorn K (2011) ‘mice: Multivariate Imputation by Chained Equations in R’, Journal of Statistical Software 45(3):1-67, <a href="http://www.jstatsoft.org/v45/i03/">http://www.jstatsoft.org/v45/i03/</a></li>
            <li class="p-1">Wickham H (2016) ggplot2: Elegant Graphics for Data Analysis, New York: Springer-Verlag, <a href="http://ggplot2.org">http://ggplot2.org</a></li>
            <li class="p-1">Wickham H (2016) rvest: Easily Harvest (Scrape) Web Pages, R package version 0.3.2, <a href="https://CRAN.R-project.org/package=rvest">https://CRAN.R-project.org/package=rvest</a></li>
            <li class="p-1">Wickham H (2017) scales: Scale Functions for Visualization, R package version 0.5.0, <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a></li>
            <li class="p-1">Wickham H (2017) stringr: Simple, Consistent Wrappers for Common String Operations, R package version 1.2.0, <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a></li>
            <li class="p-1">Wickham H and Bryan J (2017) readxl: Read Excel Files, R package version 1.0.0, <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a></li>
            <li class="p-1">Wickham H, Francois R, Henry L and Müller K (2017) dplyr: A Grammar of Data Manipulation, R package version 0.7.4, <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a></li>
            <li class="p-1">Wickham H and Henry L (2017) tidyr: Easily Tidy Data with 'spread()' and 'gather()' Functions, R package version 0.7.2, <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a></li>
            <li class="p-1">Wickham H, Hester J and Francois R (2017) readr: Read Rectangular Text Data, R package version 1.1.1, <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a></li>
            <li class="p-1">Wickham H and Miller E (2017) haven: Import and Export 'SPSS', 'Stata' and 'SAS' Files, R package version 1.1.0, <a href="https://CRAN.R-project.org/package=haven">https://CRAN.R-project.org/package=haven</a></li>
          </ul>
        </small>
      </div>
      <div class="col-sm order-first"><h5>Country codes</h4>
        <small>
        <dl class="row">
        <dt class="col-sm-3" style="text-align:right">AUS</dt>
        <dd class="col-sm-9">Australia</dd>
        <dt class="col-sm-3" style="text-align:right">AUT</dt>
        <dd class="col-sm-9">Austria</dd>
        <dt class="col-sm-3" style="text-align:right">BEL</dt>
        <dd class="col-sm-9">Belgium</dd>
        <dt class="col-sm-3" style="text-align:right">BGR</dt>
        <dd class="col-sm-9">Bulgaria</dd>
        <dt class="col-sm-3" style="text-align:right">CAN</dt>
        <dd class="col-sm-9">Canada</dd>
        <dt class="col-sm-3" style="text-align:right">CHE</dt>
        <dd class="col-sm-9">Switzerland</dd>
        <dt class="col-sm-3" style="text-align:right">CHL</dt>
        <dd class="col-sm-9">Chile</dd>
        <dt class="col-sm-3" style="text-align:right">CZE</dt>
        <dd class="col-sm-9">Czechia</dd>
        <dt class="col-sm-3" style="text-align:right">DEU</dt>
        <dd class="col-sm-9">Germany</dd>
        <dt class="col-sm-3" style="text-align:right">DNK</dt>
        <dd class="col-sm-9">Denmark</dd>
        <dt class="col-sm-3" style="text-align:right">ESP</dt>
        <dd class="col-sm-9">Spain</dd>
        <dt class="col-sm-3" style="text-align:right">EST</dt>
        <dd class="col-sm-9">Estonia</dd>
        <dt class="col-sm-3" style="text-align:right">FIN</dt>
        <dd class="col-sm-9">Finland</dd>
        <dt class="col-sm-3" style="text-align:right">FRA</dt>
        <dd class="col-sm-9">France</dd>
        <dt class="col-sm-3" style="text-align:right">GBR</dt>
        <dd class="col-sm-9">United Kingdom</dd>
        <dt class="col-sm-3" style="text-align:right">GRC</dt>
        <dd class="col-sm-9">Greece</dd>
        <dt class="col-sm-3" style="text-align:right">HRV</dt>
        <dd class="col-sm-9">Croatia</dd>
        <dt class="col-sm-3" style="text-align:right">HUN</dt>
        <dd class="col-sm-9">Hungary</dd>
        <dt class="col-sm-3" style="text-align:right">IRL</dt>
        <dd class="col-sm-9">Ireland</dd>
        <dt class="col-sm-3" style="text-align:right">ISL</dt>
        <dd class="col-sm-9">Iceland</dd>
        <dt class="col-sm-3" style="text-align:right">ISR</dt>
        <dd class="col-sm-9">Israel</dd>
        <dt class="col-sm-3" style="text-align:right">ITA</dt>
        <dd class="col-sm-9">Italy</dd>
        <dt class="col-sm-3" style="text-align:right">JPN</dt>
        <dd class="col-sm-9">Japan</dd>
        <dt class="col-sm-3" style="text-align:right">KOR</dt>
        <dd class="col-sm-9">South Korea</dd>
        <dt class="col-sm-3" style="text-align:right">LTU</dt>
        <dd class="col-sm-9">Lithuania</dd>
        <dt class="col-sm-3" style="text-align:right">LVA</dt>
        <dd class="col-sm-9">Latvia</dd>
        <dt class="col-sm-3" style="text-align:right">MEX</dt>
        <dd class="col-sm-9">Mexico</dd>
        <dt class="col-sm-3" style="text-align:right">NLD</dt>
        <dd class="col-sm-9">The Netherlands</dd>
        <dt class="col-sm-3" style="text-align:right">NOR</dt>
        <dd class="col-sm-9">Norway</dd>
        <dt class="col-sm-3" style="text-align:right">NZL</dt>
        <dd class="col-sm-9">New Zealand</dd>
        <dt class="col-sm-3" style="text-align:right">POL</dt>
        <dd class="col-sm-9">Poland</dd>
        <dt class="col-sm-3" style="text-align:right">PRT</dt>
        <dd class="col-sm-9">Portugal</dd>
        <dt class="col-sm-3" style="text-align:right">ROU</dt>
        <dd class="col-sm-9">Romania</dd>
        <dt class="col-sm-3" style="text-align:right">SVK</dt>
        <dd class="col-sm-9">Slovakia</dd>
        <dt class="col-sm-3" style="text-align:right">SVN</dt>
        <dd class="col-sm-9">Slovenia</dd>
        <dt class="col-sm-3" style="text-align:right">SWE</dt>
        <dd class="col-sm-9">Sweden</dd>
        <dt class="col-sm-3" style="text-align:right">TUR</dt>
        <dd class="col-sm-9">Turkey</dd>
        <dt class="col-sm-3" style="text-align:right">USA</dt>
        <dd class="col-sm-9">United States of America</dd>
        </dl>
      </small>
      </div>
    </div>
  </div>


</div>

</div>

</div>
</div>



<script>
  var selectCtry = $('#select-country').selectize(
    {
      allowEmptyOption: true,
      onChange: function (value) {plot_graphs(), filter_table();}
      }
  );

  var selectInd = $('#select-indicator').selectize(
    {
      onChange: function (value) {plot_graphs(), filter_table();}
    }
  );

  var selectizeCountry = selectCtry[0].selectize;
  var selectizeIndicator = selectInd[0].selectize;

  function plot_graphs() {

    var country_colour = "#8c510a"
    var incise_colour = "#5ab4ac"

    Plotly.d3.json("data/test_graph.JSON", function(err, rows){
        function unpack(rows, key) {
            return rows.map(function(row) { return row[key]; });
        }

        var sub_width = null
        var sub_height = null

        if ($(document).width() < 850) {
          sub_width = 750;
          sub_height = 700;
        } else if ($(document).width() < 1200) {
          sub_width = 800;
          sub_height = 600;
        } else{
          sub_width = 900;
          sub_height = 700;
        }

        var base_bar = {
          name: "All countries",
          y: unpack(rows, 'cc_iso3c'),
          x: unpack(rows, 'value'),
          mode: 'markers',
          type: 'bar',
          orientation: 'h',
          marker: {
            color: '#bdbdbd'
          },
          transforms: [{
            type: 'filter',
            target: unpack(rows, 'score'),
            operation: '==',
            value: selectizeIndicator.getValue()
          }, {
            type: 'sort',
            target: 'x',
            order: 'ascending'
          }
        ],
        hoverinfo: 'x',
        hoverlabel: {
          bgcolor: '#333333',
          bordercolor: '#ffffff',
        }
        }

        var bar_incise = {
          name: "InCiSE average",
          y: unpack(rows, 'cc_iso3c'),
          x: unpack(rows, 'value'),
          mode: 'markers',
          type: 'bar',
          orientation: 'h',
          marker: {
            color: incise_colour
          },
          transforms: [{
            type: 'filter',
            target: unpack(rows, 'score'),
            operation: '=',
            value: selectizeIndicator.getValue()
          }, {
            type: 'filter',
            target: unpack(rows, 'cc_iso3c'),
            operation: '=',
            value: "InCiSE"
          }, {
            type: 'sort',
            target: 'x',
            order: 'ascending'
          }
        ],
        hoverinfo: 'skip'
        }

        var bar_country = {
          name: selectizeCountry.getItem(selectizeCountry.getValue()).text(),
          y: unpack(rows, 'cc_iso3c'),
          x: unpack(rows, 'value'),
          mode: 'markers+text',
          text: 'x',
          textposition: 'right',
          type: 'bar',
          orientation: 'h',
          marker: {
            color: country_colour
          },
          transforms: [{
            type: 'filter',
            target: unpack(rows, 'score'),
            operation: '=',
            value: selectizeIndicator.getValue()
          }, {
            type: 'filter',
            target: unpack(rows, 'cc_iso3c'),
            operation: '=',
            value: selectizeCountry.getValue()
          }, {
            type: 'sort',
            target: 'x',
            order: 'ascending'
          }
        ],
        hoverinfo: 'skip'
        }

        var bar_layout = {
          title: {
            text: selectizeIndicator.getItem(selectizeIndicator.getValue()).text() + ": overall score",
            x: 0,
            xanchor: 'left',
            font: {
              size: 14
            }
          },
          barmode: 'overlay',
          autosize: true,
          xaxis: {
            visible: true,
            range: [0,1],
            tickmode: 'array',
            tickvals: [0,0.25,0.5,0.75,1],
            showgrid: true,
            title: '',
            zeroline: true,
            fixedrange: true
          },
          yaxis: {
            fixedrange: true,
            type: 'category',
            showticklabels: true,
            tickmode: 'linear',
            tickfont: {
              size: 10
            }
          },
          showlegend: false,
          legend: {
            "orientation" : 'h'
          }
        }

        var radar_incise = {
          name: 'InCiSE average',
          type: 'scatterpolar',
          mode: 'lines+markers',
          hoverinfo: "name+r",
          theta: unpack(rows, 'graph_label'),
          r: unpack(rows, 'value'),
          marker: {
            line: {width: 2, color: incise_colour},
            size: 6,
            color: incise_colour
          },
          transforms: [{
            type: 'filter',
            target: unpack(rows, 'indicator'),
            operation: '=',
            value: selectizeIndicator.getValue()
          }, {
            type: 'filter',
            target: unpack(rows, 'cc_iso3c'),
            operation: '=',
            value: "InCiSE"
          }],
          showlegend: false
        }

        var radar_country = {
          name: selectizeCountry.getItem(selectizeCountry.getValue()).text(),
          type: 'scatterpolar',
          mode: 'lines+markers',
          theta: unpack(rows, 'graph_label'),
          r: unpack(rows, 'value'),
          hoverinfo: "name+r",
          marker: {
            line: {width: 2, color: country_colour},
            size: 8,
            color: country_colour
          },
          transforms: [{
            type: 'filter',
            target: unpack(rows, 'indicator'),
            operation: '=',
            value: selectizeIndicator.getValue()
          }, {
            type: 'filter',
            target: unpack(rows, 'cc_iso3c'),
            operation: '=',
            value: selectizeCountry.getValue()
          }],
          showlegend: false
        }

        var radar_impute = {
          name: 'Imputed results',
          type: 'scatterpolar',
          mode: 'markers',
          hoverinfo: 'text',
          text: "Imputed score",
          theta: unpack(rows, 'graph_label'),
          r: unpack(rows, 'impute'),
          marker: {
            symbol: 0,
            line: {color: country_colour, width: 2},
            size: 8,
            color: '#ffffff'
          },
          transforms: [{
            type: 'filter',
            target: unpack(rows, 'indicator'),
            operation: '=',
            value: selectizeIndicator.getValue()
          }, {
            type: 'filter',
            target: unpack(rows, 'cc_iso3c'),
            operation: '=',
            value: selectizeCountry.getValue()
          }],
          showlegend: true
        }

        var radar_layout = {
          title: {
            text: selectizeIndicator.getItem(selectizeIndicator.getValue()).text() + ": component scores",
            x: 0,
            xanchor: 'left',
            font: {
              size: 14
            }
          },
          polar: {
            radialaxis: {
              range: [0, 1.1],
              visible: true,
              tick0: 0,
              dtick: 0.25,
              ticks: "",
              showline: false,
              showticklabels: false,
              fixedrange: true
            },
            angularaxis: {
              direction: 'clockwise',
              rotation: 75,
              showline: false,
              fixedrange: true,
              ticks: ""
            },
            gridshape: 'linear'
          },
          showlegend: false,
          autosize: true,
          font: {
            size: 10
          }
        }

        if (selectizeCountry.getValue() == "") {
          var titleText = selectizeIndicator.getItem(selectizeIndicator.getValue()).text()
        } else {
          var titleText = selectizeIndicator.getItem(selectizeIndicator.getValue()).text() + ": " + selectizeCountry.getItem(selectizeCountry.getValue()).text()
        }

        var sub_layout = {
          title: {
            text: titleText,
            x: 0.05,
            xanchor: 'left'
          },
          annotations: [{
            "text": 'Source: International Civil Service Effectiveness Index (InCiSE) Index 2019',
            xref: "paper",
            x: 1.1,
            yref: "paper",
            y: -0.1,
            showarrow: false,
            xshift: 0,
            yshift: 0
          }],
          barmode: 'overlay',
          autosize: 'true',
          xaxis: {
            visible: true,
            range: [0,1],
            tickmode: 'array',
            tickvals: [0,0.25,0.5,0.75,1],
            showgrid: true,
            title: '',
            hoverformat: '.2f',
            zeroline: true,
            fixedrange: true,
            domain: [0, 0.3]
          },
          yaxis: {
            title: '',
            fixedrange: true,
            type: 'category',
            showticklabels: true,
            tickmode: 'linear',
            tickfont: {
              size: 12
            },
            domain: [0, 1],
            automargin: true
          },
          polar: {
            radialaxis: {
              range: [0, 1.1],
              visible: true,
              tick0: 0,
              dtick: 0.25,
              ticks: "",
              hoverformat: '.2f',
              showline: false,
              showticklabels: false,
              fixedrange: true
            },
            angularaxis: {
              direction: 'clockwise',
              rotation: 75,
              showline: false,
              fixedrange: true,
              ticks: ""
            },
            gridshape: 'linear',
            domain: {
              x: [0.35, 1],
              y: [0.1, 0.9]
            },
            bgcolor: 'rgba(255,255,255,0)'
          },
          showlegend: true,
          legend: {
            "orientation" : 'h',
            y: 1.1,
            x: 0.95
          },
          hovermode: 'closest',
          paper_bgcolor: '#fff',
          plot_bgcolor: '#fff',
          width: sub_width,
          height: sub_height
        }

        var sub_data = [base_bar, bar_incise, bar_country, radar_incise, radar_country, radar_impute]

        var bar_data = [base_bar, bar_incise, bar_country]

        var radar_data = [radar_incise, radar_country, radar_impute]

        var plot_config = {
          displayModeBar: true, displaylogo: false, modeBarButtonsToRemove:['select2d', 'zoom2d', 'lasso2d', 'zoomIn2d', 'zoomOut2d', 'hoverClosestCartesian', 'hoverCompareCartesian', 'toggleSpikelines', 'resetViews']};

        Plotly.newPlot('incise-graph', sub_data, sub_layout, plot_config)
        Plotly.newPlot('incise-bar', bar_data, bar_layout, plot_config)
        Plotly.newPlot('incise-radar', radar_data, radar_layout, plot_config)

    });

  };




  var dat_tab = $("#incise-table").DataTable({
        "ajax": {
          "url": 'data/test_table.JSON',
          "dataSrc": ''
        },
        "columns": [
          {"data": 'cc_iso3c', "title": "Country", "visible": false, "defaultContent": ""},
          {"data": 'indicator', "title": "Indicator", "visible": false, "defaultContent": ""},
          {"data": 'score', "title": "Indicator", "visible": false, "defaultContent": ""},
          {"data": 'label', "title": "Item", "orderable": false, "defaultContent": ""},
          {"data": 'value', "title": "Score", "defaultContent": ""},
          {"data": 'incise', "title": "InCiSE \naverage", "orderable": false, "defaultContent": ""},
          {"data": 'rank', "title": "Rank", "defaultContent": ""},
          {"data": 'status', "title": "Status", "orderable": false, "defaultContent": ""}

        ],
        "buttons" : [
          {
            "extend": 'copy',
            "text" : 'Copy',
            "title" : 'InCiSE 2019: Custom selection',
            "messageBottom" : 'Copy this table to the clipboard',
            "exportOptions" : {
              "columns": ':visible'
            }
          },
          {
            "extend": 'csv',
            "text" : 'CSV',
            "messageBottom" : 'Download this table as a CSV file',
            "filename": 'incise2019_custom',
            "exportOptions" : {
              "columns": ':visible'
            }
          },
          {
              "extend": 'csv',
              "text" : 'CSV: All',
              "messageBottom" : 'Download the whole data as a CSV file',
              "filename": 'incise2019_full',
              "exportOptions" : {
                "modifier" : {
                  "search" : 'none'
                }
              },
              customize: function (csv) {
                    var split_csv = csv.split("\n");
                    split_csv[0] = '"Country","Indicator","Item","Label","Score","InCiSE Average","Rank","Status"';
                    csv = split_csv.join("\n");
                    return(csv)
                  }
          }
        ],
        "paging": false,
        "dom": 'tB'


      });

var ref_tab = $("#ref-table").DataTable({
      "ajax": {
        "url": 'data/incise2019-reference.JSON',
        "dataSrc": ''
      },
      "columns": [
        {"data": 'indicator', "title": "Indicator", "visible": false, "defaultContent": ""},
        {"data": 'item', "title": "Item", "visible": false, "defaultContent": ""},
        {"data": 'label', "title": "Label", "defaultContent": "", "orderable": false,},
        {"data": 'description', "title": "Description", "orderable": false, "defaultContent": ""},
        {"data": 'year', "title": "Reference year", "orderable": false, "defaultContent": ""},
        {"data": 'source', "title": "Data source", "orderable": false, "defaultContent": ""},
        {"data": 'type', "title": "Data type", "orderable": false, "defaultContent": ""},
        {"data": 'proxy', "title": "Public sector proxy", "orderable": false, "defaultContent": ""},
        {"data": 'type', "title": "Data transformation", "orderable": false, "defaultContent": ""},
        {"data": 'wt_total', "title": "Total weight", "orderable": false, "defaultContent": ""},
        {"data": 'datapoints', "title": "# of datapoints", "orderable": false, "defaultContent": ""}

      ],
      "buttons" : [
        {
          "extend": 'copy',
          "text" : 'Copy',
          "title" : 'InCiSE 2019 reference: Custom selection',
          "messageBottom" : 'Copy this table to the clipboard',
          "exportOptions" : {
            "columns": ':visible'
          }
        },
        {
          "extend": 'csv',
          "text" : 'CSV',
          "messageBottom" : 'Download this table as a CSV file',
          "filename": 'incise2019_customreference',
          "exportOptions" : {
            "columns": ':visible'
          }
        },
        {
            "extend": 'csv',
            "text" : 'CSV: All',
            "messageBottom" : 'Download the whole data as a CSV file',
            "filename": 'incise2019_fullreference',
            "exportOptions" : {
              "modifier" : {
                "search" : 'none'
              }
            },
            customize: function (csv) {
                  var split_csv = csv.split("\n");
                  split_csv[0] = '"Indicator","Item","Label","Description","Year","Source","Proxy","Type","Weight","Datapoints"';
                  csv = split_csv.join("\n");
                  return(csv)
                }
        }
      ],
      "paging": false,
      "dom": 'tB'


    });

function filter_table() {

      var selectedCountryVal = selectizeCountry.getValue();
      var selectedIndicatorVal = selectizeIndicator.getValue();

      var selectedCountryTxt = selectizeCountry.getItem(selectedCountryVal).text();
      var selectedIndicatorTxt = selectizeIndicator.getItem(selectedIndicatorVal).text();

      dat_tab.columns(0).search(selectedCountryVal).draw();
      dat_tab.columns(1).search(selectedIndicatorVal).draw();

      ref_tab.columns(0).search(selectedIndicatorVal).draw();

      if (selectedCountryVal == "") {
        $("#data-tab-link").addClass("disabled")
      } else {
        $("#data-tab-link").removeClass("disabled")
      }

      if (selectedIndicatorVal == "OVERALL") {
        var itemHeading = "Indicators";
      } else {
        var itemHeading = selectedIndicatorTxt + "\nmetrics"
      }

      dat_tab.columns(3).header().to$().text(itemHeading);
      dat_tab.columns(4).header().to$().text(selectedCountryTxt);
      dat_tab.columns.adjust().draw();

      ref_tab.columns(2).header().to$().text(itemHeading);
      ref_tab.columns.adjust().draw();

      var dataText = selectizeIndicator.getItem(selectizeIndicator.getValue()).text() + ": " + selectizeCountry.getItem(selectizeCountry.getValue()).text()

      var refText = selectizeIndicator.getItem(selectizeIndicator.getValue()).text() + ": metadata"

      $("#data-title").html(dataText);
      $("#ref-title").html(refText);



    }


$(document).ready(
  // $("#incise-graph").height($("#graph-container").height()),
  $("#welcome-modal").modal(),
  plot_graphs(),
  filter_table(),
  sticky_nav()
);

$("#graph-tab").on('shown.bs.tab',function(){
  plot_graphs();
});

$("#about-tab").on('shown.bs.tab',function(){
  $("#incise-controls").fadeOut();
  if($(document).width() < 992) {
    $("#incise-sidebar").hide()
  }
});

$("#about-tab").on('hide.bs.tab',function(){
  $("#incise-controls").fadeIn();
  if($(document).width() < 992) {
    $("#incise-sidebar").show()
  }
});

$('#data-tab').hover(
  function () {
    if ($('#data-tab-link').hasClass('disabled')) {
      $(this).popover('show')
    }
  },
  function () {
    $(this).popover('hide')
  }
)

$("#incise-graph").on('plotly_click', function(_, data){
  var country = data.points[0].y

  if ((typeof country) != "undefined") {
    if (country != "InCiSE") {
      selectizeCountry.setValue(country);
      plot_graphs();
      filter_table();
    }
  }

})

$("#incise-bar").on('plotly_click', function(_, data){
  var country = data.points[0].y

  if ((typeof country) != "undefined") {
    if (country != "InCiSE") {
      selectizeCountry.setValue(country);
      plot_graphs();
      filter_table();
    }
  }

})

$('#toggle-help').on('change', function(){
  if ($('#toggle-help').prop('checked') == true) {
    $(".alert").show()
  } else {
    $(".alert").hide()
  }
})

$('#toggle-intro').on('change', function(){
  if ($('#toggle-intro').prop('checked') == true) {
    $("#intro-modal").modal()
  }
})

$('#intro-modal').on('hide.bs.modal', function(){
  $('#toggle-intro').prop('checked', false)
})

$('#welcome-more-btn').click( function(){
  $('#welcome-modal').modal('hide');
  $("#intro-modal").modal();
})

$('.help > .close').click(function(data){
  $('.help').hide();
  $('#toggle-help').prop('checked', false)
})

function sticky_nav() {
  if ($(document).width() < 768) {
    $(".navbar").removeClass("sticky-top");
  } else {
    $(".navbar").addClass("sticky-top");
  }
}

function purge_plots() {
  Plotly.purge("incise-graph");
  Plotly.purge("incise-bar");
  Plotly.purge("incise-radar");
}

$(window).resize(function(){
  purge_plots();
  plot_graphs();
  sticky_nav();
});

</script>

</body>
</html>
